------------------------4번---------------------------------------
CREATE TABLE STORES (
 STORE_ID NUMBER PRIMARY KEY,
 STORE_NAME VARCHAR2(100) NOT NULL,
 PHONE VARCHAR2(100) NOT NULL,
 ADDRESS VARCHAR2(255) NOT NULL
);

CREATE TABLE CUSTOMERS(
 CUSTOMER_ID NUMBER PRIMARY KEY,
 NAME VARCHAR2(100) NOT NULL,
 PHONE VARCHAR2(100) NOT NULL,
 ADDRESS VARCHAR2(255) NOT NULL
);

CREATE TABLE ORDERS(
 ORDER_ID NUMBER PRIMARY KEY,
 CUSTOMER_ID NUMBER NOT NULL,
 CONSTRAINT FK_CUSTOMER_ID FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMERS(CUSTOMER_ID),
 STORE_ID NUMBER NOT NULL,
 CONSTRAINT FK_STORE_ID FOREIGN KEY (STORE_ID) REFERENCES STORES(STORE_ID),
 STATUS NUMBER NOT NULL,
 ORDER_DATE DATE NOT NULL
);

CREATE TABLE ORDER_ITEMS(
ITEM_ID NUMBER PRIMARY KEY,
ORDER_ID NUMBER NOT NULL,
CONSTRAINT FK_ORDER_ID FOREIGN KEY (ORDER_ID) REFERENCES ORDERS(ORDER_ID),
ITEM_NAME VARCHAR2(100) NOT NULL,
PRICE NUMBER NOT NULL,
QUANTITY NUMBER NOT NULL
);
-------------------------5번--------------------------------------
CREATE SEQUENCE ORDERS_SEQ
    INCREMENT BY 1
    START WITH 1
    MINVALUE 1
    MAXVALUE 9999
    NOCYCLE
    NOCACHE
    NOORDER;

CREATE SEQUENCE ORDERS_ITEMS_SEQ
    INCREMENT BY 1
    START WITH 1
    MINVALUE 1
    MAXVALUE 9999
    NOCYCLE
    NOCACHE
    NOORDER;
--------------------------6번-------------------------------------
--*STORES 테이블
--101, '완미족발', '02-142-9933', '서울 강남구 강남대로118길'
--102, '만구기네화로불닭발', '02-540-1974', '서울 강남구 강남대로122길 30'
--103, 'BBQ치킨', '02-142-0798', '서울 서초구 강남대로79길 48 1층'
--104, '금강바베큐', '02-511-0976', '서울 서초구 사평대로 349 서초빌딩'

INSERT INTO STORES VALUES (101, '완미족발', '02-142-9933', '서울 강남구 강남대로118길');
INSERT INTO STORES VALUES (102, '만구기네화로불닭발', '02-540-1974', '서울 강남구 강남대로122길 30');
INSERT INTO STORES VALUES (103, 'BBQ치킨', '02-142-0798', '서울 서초구 강남대로79길 48 1층');
INSERT INTO STORES VALUES (104, '금강바베큐', '02-511-0976', '서울 서초구 사평대로 349 서초빌딩');

--*CUSTOMERS 테이블
--10, '이지은', '010-2222-3333', '서울 서초구 서초대로77길 55 에이프로스퀘어 3층'
--20, '유재석', '010-3333-3333', '서울 서초구 서초대로77길 55 에이프로스퀘어 2층'
--30, '하하', '010-4444-4444', '서울 서초구 서초대로77길 55 에이프로스퀘어 1층'

INSERT INTO CUSTOMERS VALUES (10, '이지은', '010-2222-3333', '서울 서초구 서초대로77길 55 에이프로스퀘어 3층');
INSERT INTO CUSTOMERS VALUES (20, '유재석', '010-3333-3333', '서울 서초구 서초대로77길 55 에이프로스퀘어 2층');
INSERT INTO CUSTOMERS VALUES (30, '하하', '010-4444-4444', '서울 서초구 서초대로77길 55 에이프로스퀘어 1층');
--
--*ORDERS 테이블
--ORDERS_SEQ시퀀스이용, 10, 101, 0, '2016-09-01-151212'을 'YYYY-MM-DD-HH24MISS'로 포매팅
--ORDERS_SEQ시퀀스이용, 20, 102, 0, '2016-09-02-151212'을 'YYYY-MM-DD-HH24MISS'로 포매팅
--ORDERS_SEQ시퀀스이용, 20, 103, 0, '2016-09-03-151212'을 'YYYY-MM-DD-HH24MISS'로 포매팅
--ORDERS_SEQ시퀀스이용, 30, 104, 0, '2016-09-04-151212'을 'YYYY-MM-DD-HH24MISS'로 포매팅
--ORDERS_SEQ시퀀스이용, 30, 101, 0, '2016-09-05-151212'을 'YYYY-MM-DD-HH24MISS'로 포매팅

INSERT INTO ORDERS VALUES (ORDERS_SEQ.nextval, 10, 101, 0, TO_DATE('2016-09-01-151212', 'YYYY-MM-DD-HH24MISS'));
INSERT INTO ORDERS VALUES (ORDERS_SEQ.nextval, 20, 102, 0, TO_DATE('2016-09-02-151212', 'YYYY-MM-DD-HH24MISS'));
INSERT INTO ORDERS VALUES (ORDERS_SEQ.nextval, 20, 103, 0, TO_DATE('2016-09-03-151212', 'YYYY-MM-DD-HH24MISS'));
INSERT INTO ORDERS VALUES (ORDERS_SEQ.nextval, 30, 104, 0, TO_DATE('2016-09-04-151212', 'YYYY-MM-DD-HH24MISS'));
INSERT INTO ORDERS VALUES (ORDERS_SEQ.nextval, 30, 101, 0, TO_DATE('2016-09-05-151212', 'YYYY-MM-DD-HH24MISS'));

--*ORDER_ITEMS 테이블
--ORDER_ITEMS_SEQ시퀀스이용, 1, '불족발', 35000, 1
--ORDER_ITEMS_SEQ시퀀스이용, 2, '불닭발', 28000, 1
--ORDER_ITEMS_SEQ시퀀스이용, 3, '황금올리브', 28000, 1
--ORDER_ITEMS_SEQ시퀀스이용, 4, '바베큐', 48000, 1
--ORDER_ITEMS_SEQ시퀀스이용, 5, '불족발', 48000, 1

INSERT INTO ORDER_ITEMS VALUES (ORDERS_ITEMS_SEQ.nextval, 1, '불족발', 35000, 1);
INSERT INTO ORDER_ITEMS VALUES (ORDERS_ITEMS_SEQ.nextval, 2, '불닭발', 28000, 1);
INSERT INTO ORDER_ITEMS VALUES (ORDERS_ITEMS_SEQ.nextval, 3, '황금올리브', 28000, 1);
INSERT INTO ORDER_ITEMS VALUES (ORDERS_ITEMS_SEQ.nextval, 4, '바베큐', 48000, 1);
INSERT INTO ORDER_ITEMS VALUES (ORDERS_ITEMS_SEQ.nextval, 5, '불족발', 48000, 1);


--------------------------7번-------------------------------------
SELECT NAME, PHONE FROM CUSTOMERS;

--------------------------8번-------------------------------------
SELECT * FROM ORDER_ITEMS;

SELECT SUM(QUANTITY) "총 주문수량" FROM ORDER_ITEMS;

--------------------------10번-------------------------------------
SELECT * FROM STORES;
SELECT * FROM STORES WHERE PHONE LIKE '%142%';

--------------------------11번-------------------------------------

SELECT NAME, ORDER_DATE
    FROM CUSTOMERS C
    INNER JOIN ORDERS O
    ON C.CUSTOMER_ID = O.CUSTOMER_ID;
    
--------------------------12번-------------------------------------    
SELECT STORE_ID, COUNT(ORDER_ID) AS COUNT FROM ORDERS GROUP BY STORE_ID HAVING COUNT(ORDER_ID) = 1;

--------------------------13번-------------------------------------    
SELECT * FROM ORDER_ITEMS 
    WHERE ORDER_ID IN (SELECT ORDER_ID FROM ORDERS WHERE CUSTOMER_ID = 10);

--------------------------14번-------------------------------------
CREATE VIEW ORDER_ITEMS_LIST AS SELECT ITEM_NAME FROM ORDER_ITEMS WHERE PRICE >= 40000;

--------------------------15번-------------------------------------
DROP TABLE STORES CASCADE CONSTRAINTS;
DROP TABLE CUSTOMERS CASCADE CONSTRAINTS;
DROP TABLE ORDERS CASCADE CONSTRAINTS;
DROP TABLE ORDER_ITEMS CASCADE CONSTRAINTS;

DROP TABLE STORES;
DROP TABLE CUSTOMERS;
DROP TABLE ORDERS;
DROP TABLE ORDER_ITEMS;